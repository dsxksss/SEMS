# 测试环境配置
server.port=8080
server.servlet.context-path=/api

# 使用H2内存数据库进行测试，关闭自动DDL
spring.datasource.url=jdbc:h2:mem:sems_test;MODE=MySQL;DATABASE_TO_LOWER=TRUE;DB_CLOSE_DELAY=-1
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driver-class-name=org.h2.Driver
spring.h2.console.enabled=true

# 禁用JPA自动创建表
spring.jpa.hibernate.ddl-auto=none
spring.jpa.generate-ddl=false

# MyBatis配置
mybatis.mapper-locations=classpath:mapper/*.xml
mybatis.type-aliases-package=com.sems.sportseventmanagementsystem.model.entity
mybatis.configuration.map-underscore-to-camel-case=true

# 测试环境中使用固定的JWT密钥
jwt.secret=testSecretKey12345678901234567890123456789012
jwt.expiration=86400000

# 日志配置 - 提高级别以便查看详细错误
logging.level.com.sems=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.mybatis=DEBUG
logging.level.org.h2=DEBUG

# 测试环境中禁用Swagger
springdoc.api-docs.enabled=false
springdoc.swagger-ui.enabled=false

# 执行测试专用的数据库初始化脚本
spring.sql.init.mode=always
spring.sql.init.schema-locations=classpath:schema-test.sql
spring.sql.init.data-locations=classpath:data-test.sql

# 解决Bean冲突问题
spring.main.allow-bean-definition-overriding=true

# 禁用Spring Security自动配置
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,org.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration

# 增加加载超时时间
spring.test.constructor.autowire.mode=ALL

# 允许循环依赖
spring.main.allow-circular-references=true

# 禁止将未捕获的异常当作错误日志处理
logging.level.org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver=DEBUG 